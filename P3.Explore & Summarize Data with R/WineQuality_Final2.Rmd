---
title: "Red Wine Quality Analysis"
output:
  html_document: default
  pdf_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r echo=FALSE, message=FALSE, warning=FALSE, packages}
#Load the Libraries
library(dplyr)
library(ggthemes)
library(ggplot2)
library(ggExtra)
library(readr)
library(reshape2)
library(stats)
library(tibble)
library(tidyr)
library(GGally) # for ggpairs
library(gridExtra) #grid.arrange fn
library(ISLR) #mathematical models
library(caTools)
library(class)
library(e1071)
library(corrplot) # We'll use corrplot later on in this example too.
library(visreg) # This library will allow us to show multivariate graphs.
library(knitr)
library(scatterplot3d)
```

*Written by Savahnna L. Cunningham*

*Date: October 17, 2017*

```{r echo=FALSE, message=FALSE, warning=FALSE}
# Load the Data
wine<- read_csv("~/Desktop/P3.EDA with R/wineQualityReds.csv")

```


The Red Wine dataset is publicly available for research. The details are<br> 
described in [Cortez et al., 2009].

**P. Cortez, A. Cerdeira, F. Almeida, T. Matos and J. Reis. Modeling wine<br> preferences by data mining from physicochemical properties. In Decision Support<br> Systems, Elsevier, 47(4):547-553. ISSN: 0167-9236.**

Available at: 

* [Elsevier](http://dx.doi.org/10.1016/j.dss.2009.05.016)
* [Pre-press (pdf)](http://www3.dsi.uminho.pt/pcortez/winequality09.pdf)
* [bib](http://www3.dsi.uminho.pt/pcortez/dss09.bib)


# Introduction

The goal of this analysis is to quantify and gain an understanding of how<br> 
chemical properties impact the quality rating of red wine. The dataset contains<br> 1599 red wine samples with 11 variables, quantifying the physicochemical<br> 
properties of wine. The wine samples in this dataset are related to red variants<br>
of the Portuguese "Vinho Verde" wine.

A multiple regression analysis will be conducted on the dataset to test how<br>
changes in the 11 independent physicochemical properties predict a level of<br> 
change in the quality rating of a wine. The f-test will be used to determine<br> 
which predictor variables merit inclusion in the model.

The statistical hypotheses for this analysis are as follows: 

H0 (Null Hypothesis): Combinations of the 11 independent physicochemical<br>
properties (μI) have no relationship in predicting the outcome of the dependent<br> 
quality rating of a wine (μD), which can be mathematically represented as

  *H0: μI = μD*  
    
H1 (Alternate Hypothesis): Two or more of the 11 independent physicochemical<br>
properties (μI) predict the outcome of the dependent quality rating of a wine<br> 
(μD), which can be mathematically represented as

  *HA:  μI > μD*



#### Attribute information:

    
   Input variables (based on physicochemical tests):
   
     1 - fixed acidity (tartaric acid - g / dm^3)
     
     2 - volatile acidity (acetic acid - g / dm^3)
     
     3 - citric acid (g / dm^3)
     
     4 - residual sugar (g / dm^3)
     
     5 - chlorides (sodium chloride - g / dm^3
     
     6 - free sulfur dioxide (mg / dm^3)
     
     7 - total sulfur dioxide (mg / dm^3)
     
     8 - density (g / cm^3)
     
     9 - pH
     
     10 - sulphates (potassium sulphate - g / dm3)
     
     11 - alcohol (% by volume)
     
     Output variable (based on sensory data): 
     
     12 - quality (score between 0 and 10)

#### Description of attributes:
    
    1 - fixed acidity: most acids involved with wine or fixed or nonvolatile
        (do not evaporate readily)
    
    2 - volatile acidity: the amount of acetic acid in wine, which at too high 
        of levels can lead to an unpleasant, vinegar taste
    
    3 - citric acid: found in small quantities, citric acid can add 'freshness' 
        and flavor to wines
    
    4 - residual sugar: the amount of sugar remaining after fermentation stops, 
        it's rare to find wines with less than 1 gram/liter and wines with 
        greater than 45 grams/liter are considered sweet
    
    5 - chlorides: the amount of salt in the wine
    
    6 - free sulfur dioxide: the free form of SO2 exists in equilibrium between 
        molecular SO2 (as a dissolved gas) and bisulfite ion; it prevents 
        microbial growth and the oxidation of wine
    
    7 - total sulfur dioxide: amount of free and bound forms of S02; in low      
        concentrations, SO2 is mostly undetectable in wine, but at free SO2     
        concentrations over 50 ppm, SO2 becomes evident in the nose and taste 
        of wine.
    
    8 - density: the density of water is close to that of water depending on 
        the percent alcohol and sugar content
    
    9 - pH: describes how acidic or basic a wine is on a scale from 0 
        (very acidic) to 14 (very basic); most wines are between 3-4 on the 
        pH scale
    
    10 - sulphates: a wine additive which can contribute to sulfur dioxide 
         gas (S02) levels, wich acts as an antimicrobial and antioxidant
    
    11 - alcohol: the percent alcohol content of the wine
    
        Output variable (based on sensory data): 
    12 - quality (score between 0 and 10)


------

# Methodology

## Univariate Plots & Analysis 


Summary table representing the 13 variable names. The X1 column represents the<br> wine ID. The 'quality' variable is the dependent variable and is qualitative<br>
data based on a perceived like or dislike for the wine sample.


```{r echo=FALSE}
#Distribution summary of the dataset
summary(wine)
```


**Creating a Categorical Variable**

The variable quality is of numeric type ‘int’ and not conducive for data<br> analysis. The first step will be to change the numeric type of the quality<br> variable to a factor and add it to the data frame as a new variable<br> quality.rating. Additionally, three categories of quality will be added:<br>
good (>= 7), bad (<=4), and mediocre (5 and 6).

```{r}
# Gained inspiration for this code from the R-Bloggers website[6&7].

wine$quality.rating <- factor(wine$quality)
wine$quality.rating <- NA
wine$quality.rating <- ifelse(wine$quality>=7, 
                              'good', NA)
wine$quality.rating <- ifelse(wine$quality<=4, 
                              'bad', 
                              wine$quality.rating)
wine$quality.rating<- ifelse(wine$quality==5, 
                             'mediocre', 
                             wine$quality.rating)
wine$quality.rating <- ifelse(wine$quality==6, 
                              'mediocre', 
                              wine$quality.rating)
wine$quality.rating <- factor(wine$quality.rating, 
                              levels = c("bad", "mediocre", "good"))
```



```{r echo=FALSE, message=FALSE, warning=FALSE}
g8 <- ggplot(data=wine, aes(wine$quality)) + 
  geom_histogram(stat = 'count',
                 position = "dodge",
                 fill = "#cc0000", 
                 binwidth = 1) + 
  theme_dark()+
  ggtitle('Raw Quality Score Histogram') + 
  theme(text = element_text(size=10)) +
  labs(x='Raw Quality Score',y='Frequency')

g9 <- ggplot(data=wine, aes(wine$quality.rating)) + 
  geom_histogram(stat = 'count',
                 position = "dodge",
                 fill = "#cc0000", 
                 binwidth = 1) + 
  theme_dark()+
  ggtitle('Categorical Quality Rating Histogram') + 
  theme(text = element_text(size=10)) +
  labs(x='Quality Rating',y='Frequency')

```

```{r echo=FALSE, message=FALSE, warning=FALSE}
grid.arrange(g8,g9, ncol=1) 
```


The visualizations represent the distribution of the dependent variable analyzed<br>
in the dataset. The upper plot is a histogram of the raw wine quality score.<br>
As you can see, most of the wine samples have a score between 5 and 6. The raw<br> quality data was transformed into categorical data to better analyze the<br> information. Score with values of 4 or less were labeled as "bad", scores<br> between 5-6 were labeled as "mediocre" and a score with a 7 or higher was<br> labeled "good". The bottom visualization depicts the categorical distribution of<br> the quality score. As you can see, nearly all wine samples fall into the<br> mediocre category with "good" samples having ~250 samples in the dataset and<br> "bad" wine being the least common.


### Normal Distribution Plots

The following independent variables have a normal or close-to-normal distribution:<br> fixed.acidity, volatile.acidity, density, pH and alcohol content with the<br> exception of citric acid, which has a bimodal distribution.


```{r echo=FALSE, message=FALSE, warning=FALSE}

grid.arrange(ggplot(wine,aes(x=1,y=fixed.acidity))+
               theme_bw() +
               geom_jitter(alpha=0.25) + 
               geom_boxplot( alpha = .5,color = '#cc0000')+
               stat_summary(fun.y = "mean", 
               geom = "point", 
               color = "blue", 
               shape = 8, 
               size = 4),
             ggplot(wine,aes(x=fixed.acidity)) + 
               theme_bw()+
               geom_histogram(bins = 30), ncol=2)


```



```{r echo=FALSE, message=FALSE, warning=FALSE}

grid.arrange(ggplot(wine,aes(x=1,y=volatile.acidity))+
               theme_bw() +
               geom_jitter(alpha=0.25) +
               geom_boxplot( alpha = .5,color = '#cc0000')+
               stat_summary(fun.y = "mean", 
               geom = "point", 
               color = "blue", 
               shape = 8, 
               size = 4),
             ggplot(wine,aes(x=volatile.acidity)) + 
               theme_bw()+
               geom_histogram(bins = 30), ncol=2)
```


```{r echo=FALSE, message=FALSE, warning=FALSE}

grid.arrange(ggplot(wine,aes(x=1,y=citric.acid))+
               theme_bw() +
               geom_jitter(alpha=0.25) +
               geom_boxplot( alpha = .5,color = '#cc0000')+
               stat_summary(fun.y = "mean", 
               geom = "point", 
               color = "blue", 
               shape = 8, 
               size = 4),
             ggplot(wine,aes(x=citric.acid)) + 
               theme_bw()+
               geom_histogram(bins = 30), ncol=2)
```




```{r echo=FALSE, message=FALSE, warning=FALSE}

grid.arrange(ggplot(wine,aes(x=1,y=density))+
               theme_bw() +
               geom_jitter(alpha=0.25) +
               geom_boxplot( alpha = .5,color = '#cc0000')+
               stat_summary(fun.y = "mean", 
               geom = "point", 
               color = "blue", 
               shape = 8, 
               size = 4),
             ggplot(wine,aes(x=density)) + 
               theme_bw()+
               geom_histogram(bins = 30), ncol=2)

```



```{r echo=FALSE, message=FALSE, warning=FALSE}

grid.arrange(ggplot(wine,aes(x=1,y=pH))+
               theme_bw() +
               geom_jitter(alpha=0.25) +
               geom_boxplot( alpha = .5,color = '#cc0000')+
               stat_summary(fun.y = "mean", 
               geom = "point", 
               color = "blue", 
               shape = 8, 
               size = 4),
             ggplot(wine,aes(x=pH)) + 
               theme_bw()+
               geom_histogram(bins = 30), ncol=2)
```



```{r echo=FALSE, message=FALSE, warning=FALSE}

grid.arrange(ggplot(wine,aes(x=1,y=alcohol))+
               theme_bw() +
               geom_jitter(alpha=0.25) +
               geom_boxplot( alpha = .5,color = '#cc0000')+
               stat_summary(fun.y = "mean", 
               geom = "point", 
               color = "blue", 
               shape = 8, 
               size = 4),
             ggplot(wine,aes(x=alcohol)) + 
               theme_bw()+
               geom_histogram(bins = 30), ncol=2)
```



### Transformations to near normality
The residual.sugar, chlorides, free.sulfur.dioxide, total.sulfur.dioxide and<br> 
sulphates variables do not have a normal or close-to-normal distribution. The<br> variables have right-skewed distributions, therefore, the data<br>
will be transformed to near normality using a logarithmic function [4,13].


```{r echo=FALSE, message=FALSE, warning=FALSE}

grid.arrange(ggplot(wine,aes(x=1,y=residual.sugar))+
               theme_bw() +
               geom_jitter(alpha=0.25) +
               geom_boxplot( alpha = .5,color = '#cc0000')+
               stat_summary(fun.y = "mean", 
               geom = "point", 
               color = "blue", 
               shape = 8, 
               size = 4),
             ggplot(wine,aes(x = log10(residual.sugar))) + 
               theme_bw()+
               geom_histogram(bins = 30), ncol=2)
```



```{r echo=FALSE, message=FALSE, warning=FALSE}

grid.arrange(ggplot(wine,aes(x=1,y=chlorides))+
               theme_bw() +
               geom_jitter(alpha=0.25) +
               geom_boxplot( alpha = .5,color = '#cc0000')+
               stat_summary(fun.y = "mean", 
               geom = "point", 
               color = "blue", 
               shape = 8, 
               size = 4),
             ggplot(wine,aes(x = log10(chlorides))) + 
               theme_bw()+
               geom_histogram(bins = 30), ncol=2)
```



```{r echo=FALSE, message=FALSE, warning=FALSE}

grid.arrange(ggplot(wine,aes(x=1,y=free.sulfur.dioxide))+
               theme_bw() +
               geom_jitter(alpha=0.25) +
               geom_boxplot( alpha = .5,color = '#cc0000')+
               stat_summary(fun.y = "mean", 
               geom = "point", 
               color = "blue", 
               shape = 8, 
               size = 4),
             ggplot(wine,aes(x = log10(free.sulfur.dioxide))) + 
               theme_bw()+
               geom_histogram(bins = 30), ncol=2)
```


```{r echo=FALSE, message=FALSE, warning=FALSE}

grid.arrange(ggplot(wine,aes(x=1,y=total.sulfur.dioxide))+
               theme_bw() +
               geom_jitter(alpha=0.25) +
               geom_boxplot( alpha = .5,color = '#cc0000')+
               stat_summary(fun.y = "mean", 
               geom = "point", 
               color = "blue", 
               shape = 8, 
               size = 4),
             ggplot(wine,aes(x = log10(total.sulfur.dioxide))) + 
               theme_bw()+
               geom_histogram(bins = 30), ncol=2)
```


```{r echo=FALSE, message=FALSE, warning=FALSE}

grid.arrange(ggplot(wine,aes(x=1,y=sulphates))+
               theme_bw() +
               geom_jitter(alpha=0.25) +
               geom_boxplot( alpha = .5,color = '#cc0000')+
               stat_summary(fun.y = "mean", 
               geom = "point", 
               color = "blue", 
               shape = 8, 
               size = 4),
             ggplot(wine,aes(x = log10(sulphates))) + 
               theme_bw()+
               geom_histogram(bins = 30), ncol=2)
```


**Synopsis**

The red wine dataset contains 1599 red wine samples comprised of 11<br> 
physiochemical variables that affect a wine's perceived quality.There were 5<br>  physiochemical variables that had abnormal distributions. A logarithmic function<br> was used to better understanding of the distributions. The main features of<br> interest are the 11 independent variables and how they correlate to a wine's<br> quality. 



------


## Bivariate Plots & Analysis 


```{r fig.width=9,fig.height=9,  echo=FALSE, message=FALSE, warning=FALSE}
# Resourced R-bloggers for code inspiration [5].

require(datasets)
data("wine")
require(GGally)
require(ggplot2)

corr_plot <- function(data, mapping, ...){
  p <- ggplot(data = wine, mapping = mapping) + 
    geom_point(alpha=0.5) + 
    geom_smooth(method=loess, fill="red", color="red", ...) 
  p
}

g = ggpairs(wine,columns = 2:12, lower = list(continuous = corr_plot))
g + theme_classic() + 
  ggtitle('Correlative relationships between physiochemical characteristics')
```


Density appears to have a small positive correlation with acids. Additionally,<br>
pH has an inverse relationship with the acids, which is to be expected. 

The following pairs of independent variables have a strong correlation (>0.5):<br>

* free.sulfur.dioxide vs total sulfur.dioxide
* fixed acidity vs density
* fixed acidity vs pH
* fixed acidity vs citric acid

------

The exploratory data analysis will focus on the relationship between the<br> 
independent variables and the dependent quality rating variable. 


#### Independent Variables vs. Quality Rating: A Positive Linear Relationship 


```{r echo=FALSE, message=FALSE, warning=FALSE}
ggplot(aes(factor(quality.rating), alcohol), 
        data = wine) +
  geom_jitter( alpha = .3)  +
  geom_boxplot( alpha = .5,color = '#cc0000')+
  stat_summary(fun.y = "mean", 
               geom = "point", 
               color = "blue", 
               shape = 8, 
               size = 4) +
  theme_bw() +
      ggtitle('Alcohol Percentage vs Quality Rating') + 
      theme(text = element_text(size=12)) +
      labs(x='Quality Rating',y='Alcohol (% by volume)')
```


The visualization indicates good wine contains a higher percentage of alcohol,<br>
averaging ~11.5% by volume.


```{r echo=FALSE, message=FALSE, warning=FALSE}
ggplot(aes(factor(quality.rating), fixed.acidity), 
        data = wine) +
  geom_jitter( alpha = .3)  +
  geom_boxplot( alpha = .5,color = '#cc0000')+
  stat_summary(fun.y = "mean", 
               geom = "point", 
               color = "blue", 
               shape = 8, 
               size = 4) +
  theme_bw() +
      ggtitle('Fixed Acidity vs Quality') + 
      theme(text = element_text(size=12)) +
      labs(x='Quality Rating',y='Fixed Acidity (Tartaric Acid - g/dm³)')
```


The visualization indicates good wine contains a higher concentration of<br>
Tartaric Acid, averaging ~9 g/dm³ for good wine.
 


```{r echo=FALSE, message=FALSE, warning=FALSE}
ggplot(aes(factor(quality.rating), citric.acid), 
        data = wine) +
  geom_jitter( alpha = .3)  +
  geom_boxplot( alpha = .5,color = '#cc0000')+
  stat_summary(fun.y = "mean", 
               geom = "point", 
               color = "blue", 
               shape = 8, 
               size = 4) +
  theme_bw() +
      ggtitle('Citric Acid vs Quality') + 
      theme(text = element_text(size=12)) +
      labs(x='Quality Rating',y='Citric Acid (g/dm³)')
```


The visualization indicates good wine contains a higher quantity of citric acid.<br>
As you can see, the quality greatly improves if a wine is has a citric acid<br>
content range between 0.30 - 0.50 g/dm³, with the average citric acid<br>
concentrationg ~ 0.35 g/dm³.


```{r echo=FALSE, message=FALSE, warning=FALSE}
ggplot(aes(factor(quality.rating), sulphates), 
        data = wine) +
  geom_jitter( alpha = .3)  +
  geom_boxplot( alpha = .5,color = '#cc0000')+
  stat_summary(fun.y = "mean", 
               geom = "point", 
               color = "blue", 
               shape = 8, 
               size = 4) +
  theme_bw() +
      ggtitle('Sulphates vs Quality') + 
      theme(text = element_text(size=12)) +
      labs(x='Quality Rating',y='Sulphates (Potassium sulphate - g/dm³)')
```


The visualization indicates there is not a large variance from a good and bad<br>
wine with regards to Potassium sulphate concentration.  As you can see, the<br>
results show a good wine will have a Potassium sulphate mean concentration of<br>
~0.75 g/dm³, while a bad wine will have a mean equal to ~ 0.55 g/dm³.


------


#### Independent Variables vs. Quality Rating: A Negative Linear Relationship 


```{r echo=FALSE, message=FALSE, warning=FALSE}
ggplot(aes(factor(quality.rating), volatile.acidity), 
        data = wine) +
  geom_jitter( alpha = .3)  +
  geom_boxplot( alpha = .5,color = '#cc0000')+
  stat_summary(fun.y = "mean", 
               geom = "point", 
               color = "blue", 
               shape = 8, 
               size = 4) +
  theme_bw() +
      ggtitle('Volatile Acidity vs Quality') + 
      theme(text = element_text(size=12)) +
      labs(x='Quality Rating',y='Volatile Acidity (Acetic Acid - g/dm³)')
```


The visualization indicates that the greater the concentration of volatile acids<br>
in a wine, the worse the quality rating. To have good marks, a wine is<br>
considered good if it contains <0.4 g/dm³ acidic acid.


```{r echo=FALSE, message=FALSE, warning=FALSE}
ggplot(aes(factor(quality.rating), density), 
        data = wine) +
  geom_jitter( alpha = .3)  +
  geom_boxplot( alpha = .5,color = '#cc0000')+
  stat_summary(fun.y = "mean", 
               geom = "point", 
               color = "blue", 
               shape = 8, 
               size = 4) +
  theme_bw() +
      ggtitle('Density vs Quality') + 
      theme(text = element_text(size=12)) +
      labs(x='Quality Rating',y='Density (g/cm³)')
```


The visualization indicates that all wine samples are relatively close to the<br>
density of water, averaging around 0.9975 g/cm³, however the wine samples with a<br>
good quality rating have a slightly lower density, with a mean value equal to<br>
~ 0.996 g/cm³.


```{r echo=FALSE, message=FALSE, warning=FALSE}
ggplot(aes(factor(quality.rating), pH), 
        data = wine) +
  geom_jitter( alpha = .3)  +
  geom_boxplot( alpha = .5,color = '#cc0000')+
  stat_summary(fun.y = "mean", 
               geom = "point", 
               color = "blue", 
               shape = 8, 
               size = 4) +
  theme_bw() +
      ggtitle('pH vs Quality') + 
      theme(text = element_text(size=12)) +
      labs(x='Quality Rating',y='pH')
```


The visualization shows mediocre and good wine have a pH value <= 3.25, in<br> 
comparison to a bad quality rating, which has a higher mean pH value >= 3.25.

------

#### pH and the Non-Volatile Acid Variables

```{r echo=FALSE, message=FALSE, warning=FALSE}

g1 <- ggplot(aes(x = pH, y = citric.acid), data = wine) + 
  geom_point(alpha = 0.3, size=1,color='#cc0000') +
  coord_trans(x = "log10") +
  geom_smooth(method = "lm", color = "black", se = FALSE,size=1)+ 
  theme_classic() +
  labs(x='pH',y='Citric Acid (g/dm³)')

g2<- ggplot(aes(x = pH, y = fixed.acidity), data = wine) + 
  geom_point(alpha = 0.3, size=1,color='#cc0000') +
  coord_trans(x = "log10") +
  geom_smooth(method = "lm", color = "black", se = FALSE,size=1)+
  theme_classic() +
  labs(x='pH',y='Fixed Acidity (Tartaric Acid - g/dm³)')


grid.arrange(g1, g2, ncol = 2)
```

The visualization represents the inverse relationship between pH and the weak<br>
acids found in wine. Substances with a pH below 7.0 are termed acidic and<br>
solutions with a pH above 7.0 are termed basic. As you can see, the red wine<br>
samples as a whole are considered an acidic solution. As pH goes up, the less<br>
acidic the wine becomes.


------


#### Density and the Non-Volatile Acid Variables

```{r echo=FALSE, message=FALSE, warning=FALSE}

g1 <- ggplot(aes(x = density, y = citric.acid), data = wine) + 
  geom_point(alpha = 0.3, size=1,color='#cc0000') +
  coord_trans(x = "log10") +
  geom_smooth(method = "lm", color = "black", se = FALSE,size=1)+ 
  theme_bw() +
  labs(x='Density (g/cm³)',y='Citric Acid (g/dm³)')

g2 <- ggplot(aes(x = density, y = fixed.acidity), data = wine) + 
  geom_point(alpha = 0.3,size=1,color='#cc0000') +
  coord_trans(x = "log10") +
  geom_smooth(method = "lm", color = "black", se = FALSE,size=1) +
  theme_bw() +
  labs(x='Density (g/cm³)',y='Fixed Acidity (Tartaric Acid - g/dm³)')

grid.arrange(g1, g2,ncol = 2)

```

The visualization represents the affect acidity has on wine density. Acid<br>
molecules are creating a stronger, closely packed bond compared to the<br>
surrounding substance. Therefore, as acid molecules increase, the density of the<br>
wine also increases. 


**Synopsis**

The Bivariant analysis depicts notable relationships between wine quality and<br>
the physiochemical characteristics. As you can see from the boxplots above,<br>
there is a positive correlation between fixed acid, citric acid levels and wine<br>
quality. The higher the non-volatile acid level, the better the wine quality.<br>
Additionally, because acetic acid produces a vinegar taste, a negative<br>
correlation can be found between the volatile acid variable and wine quality. 

A good wine has the lowest density, which makes sense because density has a<br>
direct correlation with total acidity concentration. However, it is interesting<br>
to point out that there seems to be a fine line between total acidity level and<br>
pH value. For a wine to be considered good, it has to have a low volatile<br>
acidity level in conjunction with higher citric acid and fixed acid<br>
concentrations but overall total acid levels should not pass a pH value of ~3.3.
 

------


## Multivariate Plots & Analysis  


```{r echo=FALSE, message=FALSE, warning=FALSE}
ggplot(aes(x = total.sulfur.dioxide, 
           y = free.sulfur.dioxide  , color = factor(quality.rating)), 
       data = wine) +
      geom_point(alpha = 0.6, size = 1) +
      geom_smooth(method = "lm", se = FALSE,size=1)  +
  scale_color_brewer(type='seq',palette = 'PuRd',
                   guide=guide_legend(title='Quality'))+
  theme_dark() +
  theme(text = element_text(size=10)) +
  ggtitle('Free Sulfur dioxide vs Total Sulfur dioxide') +
  labs(x='Total Sulfur dioxide (mg/dm³)', y='Free Sulfur dioxide (mg/dm³)')
```


The visualization compares the free Sulfur dioxide and the total Sulfur dioxide<br> variables to the dependent quality rating variable. As you can see, a strong<br>
positive correlation exists between the dependent variable and the Sulfur<br>
dioxide variables. The majority of good wine appears to have a free Sulfur<br>
dioxide of <50 mg/dm³ and a total Sulfur dioxide concentration of<br>
<100 mg/dm³.


```{r echo=FALSE, message=FALSE, warning=FALSE}
ggplot(aes(x = fixed.acidity, 
           y = pH , color = factor(quality.rating)), 
       data = wine) +
      geom_point(alpha = 0.6, size = 1) +
      geom_smooth(method = "lm", se = FALSE,size=1)  +
  scale_color_brewer(type='seq',palette = 'PuRd',
                   guide=guide_legend(title='Quality'))+
  theme_dark() +
  theme(text = element_text(size=10)) +
  ggtitle('pH vs Fixed Acidity') +
  labs(x='Fixed Acidity (Tartaric Acid - g/dm³)', y='pH')
```


The visualization compares the Fixed Acidity and pH variables with the dependent<br>
quality rating variable. As you can see, there is an strong inverse relationship<br>
between all of the variables. This is to be expected, as pH levels rise acidity<br>
level decreases. Also of note, the good quality rating has a wide spread, even<br> distribution.


```{r echo=FALSE, message=FALSE, warning=FALSE}
ggplot(aes(x = fixed.acidity, 
           y = citric.acid , color = factor(quality.rating)), 
       data = wine) +
      geom_point(alpha = 0.6, size = 1) +
      geom_smooth(method = "lm", se = FALSE,size=1)  +
  scale_color_brewer(type='seq',palette = 'PuRd',
                   guide=guide_legend(title='Quality'))+
  theme_dark() +
  ggtitle('Citric Acid vs Fixed Acidity') + 
  theme(text = element_text(size=10)) +
  labs(x='Fixed Acidity (Tartaric Acid - g/dm³)',y='Citric Acid (g/dm³)')
```


The visualization compares the Fixed Acidity and Citric Acid variables with the<br>
wine quality rating. Results show a strong positive linear relationship between<br>
the independent variables and wine quality. Interestingly, the majority of the<br>
good quality data points cluster above a 0.25 g/dm³ citric acid value.


```{r echo=FALSE, message=FALSE, warning=FALSE}
ggplot(aes(x = volatile.acidity, 
           y = density , color = factor(quality.rating)), 
       data = wine) +
      geom_point(alpha = 0.6, size = 1) +
      geom_smooth(method = "lm", se = FALSE,size=1)  +
  scale_color_brewer(type='seq',palette = 'PuRd',
                   guide=guide_legend(title='Quality'))+
  theme_dark() +
  ggtitle('Fixed Acidity vs Density') + 
  theme(text = element_text(size=10)) +
  labs(x='Fixed Acidity (Tartaric Acid - g/dm³)',y='Density (g/cm³)')
  
```


The visualization compares the Fixed Acidity and the Density variables with the<br>
wine quality rating. Results indicate a strong positive correlation between the<br>
independent variables, however, there does not appear to be any correlative<br>
relationship between the independent and dependent variables. Interestingly,<br>
the majority of the good quality data points are clustered at or below a<br>
Tartaric Acid value of 0.4 g/dm³.<br>


------


#### Mathematical Model

The goal of the multiple linear regression model is to predict wine quality<br>
based on the chemical properties of a wine sample.

```{r}
# Multiple Linear Regression
dataset = read.csv('wineQualityReds.csv')
dataset = dataset[, 2:13]

# Splitting the dataset into the Training set and Test set
# install.packages('caTools')
library(caTools)
set.seed(123)
split = sample.split(dataset$quality, SplitRatio = 0.8)
training_set = subset(dataset, split == TRUE)
test_set = subset(dataset, split == FALSE)


# Note: Feature_Scaling will be taken care of with the function 

# Fitting Multiple Linear Regression to the Training set
regressor = lm(formula = quality ~ .,
               data = training_set)
summary(regressor)
```


```{r message=FALSE, warning=FALSE}
#Predicting the Test set results
y_pred = predict.lm(regressor, newdata = test_set,interval = "prediction",level = 0.95)

p1 <- smoothScatter(y_pred,pch = ".", cex = 5, 
                     col = "black",colramp = 
                     colorRampPalette(c("white", blues9)),
                     xlab = "Fit", 
                     ylab = "Model Prediction",
                     main="Predicted Future Values ")

```


The visualization represents the 95% prediction interval with data points<br> 
representing the models predicted values. As you can see, the model did very<br>
well predicting the wine quality value, as all data points are within the<br>
prediction interval [10]. 


```{r fig.width=5, fig.height=5, message=FALSE, warning=FALSE}
# Plot a correlation matrix
regressor= cor(test_set[1:12])

par(mar=c(5,4,1.5,2) + 0.1)  #margin padding  
p1 <- corrplot(regressor, method = "circle",tl.cex = 0.6) + 
  title(main= "Regression Model Correlation Matrix",cex.main = 1.3) 

```


The volatile acidity, chlorides, total sulfur dioxide, alcohol, sulphates have<br>
strong statistical significance on the depandent variable, while pH has a slight<br>
statistical influence on wine quality. The model did very well, now it is time<br>
to optimize it with the Backward Elimination method.


#### Model Optimization

```{r}

# Building the optimal model using Backward Elimination
regressor = lm(formula = quality ~ fixed.acidity + 
                 volatile.acidity + 
                 citric.acid + 
                 residual.sugar + 
                 chlorides +
                 free.sulfur.dioxide + 
                 total.sulfur.dioxide + 
                 density + 
                 pH +
                 sulphates +
                 alcohol,
               data = dataset)  
summary(regressor)
```


```{r eval=FALSE, echo=FALSE}
#Interation #2
regressor = lm(formula = quality ~ 
                 volatile.acidity + 
                 citric.acid + 
                 residual.sugar + 
                 chlorides +
                 free.sulfur.dioxide + 
                 total.sulfur.dioxide + 
                 density + 
                 pH +
                 sulphates +
                 alcohol,
               data = dataset)  
summary(regressor)

#Interation #3
regressor = lm(formula = quality ~ 
                 volatile.acidity + 
                 citric.acid + 
                 residual.sugar + 
                 chlorides +
                 free.sulfur.dioxide + 
                 total.sulfur.dioxide + 
                 pH +
                 sulphates +
                 alcohol,
               data = dataset)  
summary(regressor)

#Interation #4
regressor = lm(formula = quality ~ 
                 volatile.acidity + 
                 citric.acid + 
                 chlorides +
                 free.sulfur.dioxide + 
                 total.sulfur.dioxide + 
                 pH +
                 sulphates +
                 alcohol,
               data = dataset)  
summary(regressor)


#Interation #5
regressor = lm(formula = quality ~ 
                 volatile.acidity + 
                 chlorides +
                 free.sulfur.dioxide + 
                 total.sulfur.dioxide + 
                 pH +
                 sulphates +
                 alcohol,
               data = dataset)  
summary(regressor)


#Interation #6
regressor = lm(formula = quality ~ 
                 volatile.acidity + 
                 chlorides +
                 total.sulfur.dioxide + 
                 pH +
                 sulphates +
                 alcohol,
               data = dataset)  
summary(regressor)
```


```{r echo=FALSE}
#Interation #6
regressor = lm(formula = quality ~ 
                 volatile.acidity + 
                 chlorides +
                 total.sulfur.dioxide + 
                 pH +
                 sulphates +
                 alcohol,
               data = dataset)  
summary(regressor)
```


A multiple linear regression model was conducted on the dataset using the<br>
backward elimination method. The findings indicate six independent variables<br>
have a high statistical influence (p < 0.05) on the quality of a wine.  A violin<br>
plot was used to visualize the descriptive statistics of each influential<br>
variable. 

```{r echo=FALSE, message=FALSE, warning=FALSE}
g10 <- ggplot(aes(factor(quality), alcohol), 
        data = dataset) +
  geom_jitter( alpha = .2)  +
  geom_violin( alpha = .5,color = '#cc0000',position = "dodge",
               draw_quantiles = c(0.25, 0.5, 0.75))+
  stat_summary(fun.y = "mean", 
               geom = "point", 
               color = "blue", 
               shape = 8, 
               size = 4) +
  theme_bw() +
  ggtitle('Alcohol Percentage vs Quality Rating') + 
  theme(text = element_text(size=8)) +
  labs(x='Quality Rating',y='Alcohol (% by volume)')

g11 <- ggplot(aes(factor(quality), volatile.acidity), 
        data = dataset) +
  geom_jitter( alpha = .2)  +
  geom_violin( alpha = .5,color = '#cc0000',position = "dodge",
               draw_quantiles = c(0.25, 0.5, 0.75))+
  stat_summary(fun.y = "mean", 
               geom = "point", 
               color = "blue", 
               shape = 8, 
               size = 4) +
  theme_bw() +
  ggtitle('Volatile Acidity vs Quality') + 
  theme(text = element_text(size=8)) +
  labs(x='Quality Rating',y='Volatile Acidity (Acetic Acid - g/dm³)')

g12 <- ggplot(aes(factor(quality), log10(sulphates)), 
        data = dataset) +
  geom_jitter( alpha = .2)  +
  geom_violin( alpha = .5,color = '#cc0000',position = "dodge",
               draw_quantiles = c(0.25, 0.5, 0.75))+
  stat_summary(fun.y = "mean", 
               geom = "point", 
               color = "blue", 
               shape = 8, 
               size = 4) +
  theme_bw() +
  ggtitle('Sulphates vs Quality') + 
  theme(text = element_text(size=8)) +
  labs(x='Quality Rating',y='Sulphates (Potassium sulphate (g/dm³)')

g13 <- ggplot(aes(factor(quality), log10(total.sulfur.dioxide)), 
        data = dataset) +
  geom_jitter( alpha = .2)  +
  geom_violin( alpha = .5,color = '#cc0000',position = "dodge",
               draw_quantiles = c(0.25, 0.5, 0.75))+
  stat_summary(fun.y = "mean", 
               geom = "point", 
               color = "blue", 
               shape = 8, 
               size = 4) +
  theme_bw() +
  ggtitle('Total Sulfur dioxide vs Quality') + 
  theme(text = element_text(size=8)) +
  labs(x='Quality Rating',y='Total Sulfur dioxide (mg/dm³)')

g14 <- ggplot(aes(factor(quality), log10(chlorides)), 
        data = dataset) +
  geom_jitter( alpha = .2)  +
  geom_violin( alpha = .5,color = '#cc0000',position = "dodge",
               draw_quantiles = c(0.25, 0.5, 0.75))+
  stat_summary(fun.y = "mean", 
               geom = "point", 
               color = "blue", 
               shape = 8, 
               size = 4) +
  theme_bw() +
  ggtitle('Chlorides vs Quality') + 
  theme(text = element_text(size=8)) +
  labs(x='Quality Rating',y='Chlorides (Sodium chloride - g/dm³)')

g15 <- ggplot(aes(factor(quality), pH), 
        data = dataset) +
  geom_jitter( alpha = .2)  +
  geom_violin( alpha = .5,color = '#cc0000',position = "dodge",
               draw_quantiles = c(0.25, 0.5, 0.75))+
  stat_summary(fun.y = "mean", 
               geom = "point", 
               color = "blue", 
               shape = 8, 
               size = 4) +
  theme_bw() +
  ggtitle('pH vs Quality') + 
  theme(text = element_text(size=8)) +
  labs(x='Quality Rating',y='pH')
```


```{r fig.width=10, fig.height=10,echo=FALSE, message=FALSE, warning=FALSE}
grid.arrange(g10,g11,g12,g13,g14,g15, nrow=3,ncol=2) 
```

Take notice that in some cases, as with total Sulphur dioxide, chlorides, and pH<br>
the distance between a "good" vs. "bad" wine is minute. However, the three<br>
independent variables with the greatest statistical influence, alcohol, volatile<br> acidity and sulphates, do have a noticeable distance in mean quality rating<br> values. The results indicate that a good wine will have a high alcohol<br> percentage, low volatile acid concentration and a Potassium sulphate<br> concentration of ~15 g/dm³.


```{r echo=FALSE, message=FALSE, warning=FALSE}
ggplot(aes(x = fixed.acidity, 
           y = alcohol , color = factor(quality)), 
       data = dataset) +
      geom_point(alpha = 0.6, size = 1) +
      geom_smooth(method = "lm", se = FALSE,size=1)  +
  scale_color_brewer(type='seq',palette = 'YlOrRd',
                   guide=guide_legend(title='Quality'))+
  theme_dark() +
  ggtitle('Alcohol vs Volatile Acidity') + 
  theme(text = element_text(size=10)) +
  labs(x='Volatile Acidity (Acetic Acid - g/dm³)',y='Alcohol (% by volume)')
```


The visualization compares the two independent variables with the highest<br> 
statistical influence on wine quality. The results show wine quality has a<br> 
negative correlation with the independent variables, with the strongest negative<br> 
correlation seen in the 2,4,7,& 8 quality values. 

**Synopsis**

The Multivariate analysis reveals strong statistical correlations with six of<br>
the independent physicochemical properties. The scatterplot visualizations<br>
indicate that "good" wine will have low concentrations Citric Acid, Tartaric<br>
Acid, total Sulfur dioxide and free Sulfur dioxide. 

An optimized multiple linear regression model using the Backward Elimination<br>
method discovered alcohol, volatile acidity, sulphates, total sulfur dioxide,<br>
chlorides and pH have a very strong statistical influence on wine quality.

------


# Results  

The univariate analysis revealed six independent physicochemical properties have<br>
normal or close-to-normal distributions, while the remaining five properties<br>
have right-skewed distributions, requiring a logarithmic function be used to<br>
better understand the distributions.

The bivariate analysis revealed a positive linear relation between the<br>
independent physicochemical properties alcohol, fixed acidity, citric acid and<br>
sulphates and the dependent variable. A negative linear relationship exists<br>
between volatile acidity, density, pH and the quality rating. An inverse<br>
relationship exists between pH and the acids, as pH levels rise as acid levels<br>
decrease. Additionally, there is a positive correlation between density and the<br>
acids due the chemical properties that exist between an acid molecule and the<br>
surrounding substance.  Strong correlations (>0.5) were discovered between free<br>
Sulfur dioxide and total Sulfur dioxide, fixed acidity and density, fixed<br>
acidity and pH, as well as fixed acidity and citric acid.

A multiple linear regression model was used on a test set of 321 wine samples,<br>
containing 11 independent variables to predict wine quality. The model performed<br>
very well with a 95% Confidence Interval, p-value <2.2e-16, residual standard<br>
error of 0.6519 on 1266 degrees of freedom, and a F-statistic equal to 62.48 on<br>
11 variables and 1266 DF, concluding the 11 variables account for 35.48% of the<br>
variance in wine quality. 

A second multiple linear regression model utilizing the Backward Elimination<br>
method was conducted on a test set of 321 wine samples to optimize the predictor<br>
variables to determine which variables have the strongest statistical<br>
relationship with the dependent variable.

*Optimized Multiple Linear Regression Summary:* 

* Confidence Interval = 95%
* α = .05
* Degrees of Freedom = 1593
* Adjusted R-squared:  0.3495
* F-statistic: 147.4 on 6 variables and 1592 DF
* p-value = < 2.2e-16

The Backward Elimination method indicates alcohol, volatile acidity, sulphates,<br>
total sulfur dioxide, chlorides and pH physicochemical properties have a very<br>
strong statistical influence on wine quality with a 95% Confidence Interval, a<br>
p-value <2.2e-16 and a residual standard error of 0.6487 on 1592 degrees of<br>
freedom. These six physicochemical properties account for 34.95% of the variance<br>
of wine quality. The high F-statistic equal to 147.4 and small p-value of<br>
< 2.2e-16 gives sufficient statistical evidence that the six independent<br>
variables predict the quality rating of wine, therefore, the Null Hypothesis<br>
can be rejected.


------


#Final Plots and Summary

**Plot One**

```{r echo=FALSE, message=FALSE, warning=FALSE}
g8 <- ggplot(data=wine, aes(wine$quality)) + 
  geom_histogram(stat = 'count',
                 position = "dodge",
                 fill = "#cc0000", 
                 binwidth = 1) + 
  theme_dark()+
  ggtitle('Raw Quality Score Histogram') + 
  theme(text = element_text(size=10)) +
  labs(x='Raw Quality Score',y='Frequency')

g9 <- ggplot(data=wine, aes(wine$quality.rating)) + 
  geom_histogram(stat = 'count',
                 position = "dodge",
                 fill = "#cc0000", 
                 binwidth = 1) + 
  theme_dark()+
  ggtitle('Categorical Quality Rating Histogram') + 
  theme(text = element_text(size=10)) +
  labs(x='Quality Rating',y='Frequency')

```

```{r fig.width=10, fig.height=4,echo=FALSE, message=FALSE, warning=FALSE}
grid.arrange(g8,g9, nrow=1) 
```

The quality variable was of numeric type ‘int’ and not conducive for data<br>
analysis. The variable was transformed into a categorical variable. The majority<br>
of the wine samples fall into the "mediocre" quality rating.

**Plot Two**

```{r echo=FALSE, message=FALSE, warning=FALSE}
g10 <- ggplot(aes(factor(quality), alcohol), 
        data = dataset) +
  geom_jitter( alpha = .2)  +
  geom_violin( alpha = .5,color = '#cc0000',position = "dodge",
               draw_quantiles = c(0.25, 0.5, 0.75))+
  stat_summary(fun.y = "mean", 
               geom = "point", 
               color = "blue", 
               shape = 8, 
               size = 4) +
  theme_bw() +
  ggtitle('Alcohol Percentage vs Quality Rating') + 
  theme(text = element_text(size=8)) +
  labs(x='Quality Rating',y='Alcohol (% by volume)')

g11 <- ggplot(aes(factor(quality), volatile.acidity), 
        data = dataset) +
  geom_jitter( alpha = .2)  +
  geom_violin( alpha = .5,color = '#cc0000',position = "dodge",
               draw_quantiles = c(0.25, 0.5, 0.75))+
  stat_summary(fun.y = "mean", 
               geom = "point", 
               color = "blue", 
               shape = 8, 
               size = 4) +
  theme_bw() +
  ggtitle('Volatile Acidity vs Quality') + 
  theme(text = element_text(size=8)) +
  labs(x='Quality Rating',y='Volatile Acidity (Acetic Acid - g/dm³)')

g12 <- ggplot(aes(factor(quality), log10(sulphates)), 
        data = dataset) +
  geom_jitter( alpha = .2)  +
  geom_violin( alpha = .5,color = '#cc0000',position = "dodge",
               draw_quantiles = c(0.25, 0.5, 0.75))+
  stat_summary(fun.y = "mean", 
               geom = "point", 
               color = "blue", 
               shape = 8, 
               size = 4) +
  theme_bw() +
  ggtitle('Sulphates vs Quality') + 
  theme(text = element_text(size=8)) +
  labs(x='Quality Rating',y='Sulphates (Potassium sulphate (g/dm³)')

g13 <- ggplot(aes(factor(quality), log10(total.sulfur.dioxide)), 
        data = dataset) +
  geom_jitter( alpha = .2)  +
  geom_violin( alpha = .5,color = '#cc0000',position = "dodge",
               draw_quantiles = c(0.25, 0.5, 0.75))+
  stat_summary(fun.y = "mean", 
               geom = "point", 
               color = "blue", 
               shape = 8, 
               size = 4) +
  theme_bw() +
  ggtitle('Total Sulfur dioxide vs Quality') + 
  theme(text = element_text(size=8)) +
  labs(x='Quality Rating',y='Total Sulfur dioxide (mg/dm³)')

g14 <- ggplot(aes(factor(quality), log10(chlorides)), 
        data = dataset) +
  geom_jitter( alpha = .2)  +
  geom_violin( alpha = .5,color = '#cc0000',position = "dodge",
               draw_quantiles = c(0.25, 0.5, 0.75))+
  stat_summary(fun.y = "mean", 
               geom = "point", 
               color = "blue", 
               shape = 8, 
               size = 4) +
  theme_bw() +
  ggtitle('Chlorides vs Quality') + 
  theme(text = element_text(size=8)) +
  labs(x='Quality Rating',y='Chlorides (Sodium chloride - g/dm³)')

g15 <- ggplot(aes(factor(quality), pH), 
        data = dataset) +
  geom_jitter( alpha = .2)  +
  geom_violin( alpha = .5,color = '#cc0000',position = "dodge",
               draw_quantiles = c(0.25, 0.5, 0.75))+
  stat_summary(fun.y = "mean", 
               geom = "point", 
               color = "blue", 
               shape = 8, 
               size = 4) +
  theme_bw() +
  ggtitle('pH vs Quality') + 
  theme(text = element_text(size=8)) +
  labs(x='Quality Rating',y='pH')
```


```{r fig.width=10, fig.height=10,echo=FALSE, message=FALSE, warning=FALSE}
grid.arrange(g10,g11,g12,g13,g14,g15, nrow=3,ncol=2) 
```


The alcohol and sulphate variables have a positive correlation with the quality<br>
variable. Volatile acidity,chlorides and pH have a negative correlation with the<br>
quality rating. Intrestingly, total sulphur dioxide has a normal distribution<br>
with the quality variable. Results show that a good wine will have a high<br>
alcohol percentage, low volatile acid concentration and a Potassium sulphate<br>
concentration of ~15 g/dm³.



**Plot Three**

```{r echo=FALSE, message=FALSE, warning=FALSE}
ggplot(aes(x = fixed.acidity, 
           y = alcohol , color = factor(quality)), 
       data = dataset) +
      geom_point(alpha = 0.6, size = 1) +
      geom_smooth(method = "lm", se = FALSE,size=1)  +
  scale_color_brewer(type='seq',palette = 'YlOrRd',
                   guide=guide_legend(title='Quality'))+
  theme_dark() +
  ggtitle('Alcohol vs Volatile Acidity') + 
  theme(text = element_text(size=10)) +
  labs(x='Volatile Acidity (Acetic Acid - g/dm³)',y='Alcohol (% by volume)')
```


The results from the multiple linear regression model show that the alcohol and<br> 
volatile acidity have the strongest statistical influence on wine quality. This<br> 
plot compares these two variables against wine quality. As you can see, wine<br> 
quality has a negative correlation with the independent variables.


###Summary
The exploratory data analysis revealed the distributions of the 11 independent<br>
variables, as well as the interactions the physicochemical properties have with<br>
each other. The multivariate analysis focused on the independent variables with<br>
strong correlations (>0.5), results showing the fixed acidity variable, with<br>
three relations, has the greatest number of correlative influence on other<br>
independent variables.  

The dependent wine quality variable has a normal distribution with most samples<br>
having a 5-6 quality score. The alcohol content and volatile acidity<br>
concentration have the strongest statistical influence on the dependent variable<br>
with sulphates, total sulfur dioxide, chlorides and pH also having an influence<br>
on the quality of a wine. Interestingly, when the two most influential<br>
variables, alcohol content and volatile acidity, are compared with the wine<br>
quality rating variable results show good wine has an alcohol content >11.5% by<br>
volume and an Acetic Acid concentration <0.5 g/dm³. Future work on this<br>
dataset should include exploring the outliers in this analysis. Why does a wine<br>
with a high alcohol percentage and a high Acetic Acid concentration still<br>
considered a good wine? Is there a unique combination of physicochemical<br>
properties within these samples, which lead to these abnormal quality ratings?<br>

This analysis used a multiple linear regression model to account for 34.95% of<br>
the variance of wine quality. To improve the predictive power of the<br>
mathematical algorithm additional data with a wider spread of quality data<br>
should be used to improve performance results. Moreover, additional predictive<br>
models should be employed, such as Support Vector Machine (SVM), Decision Tree<br>
Regression or K-Nearest Neighbors (KNN) to provide more accurate predictions for<br>
a wine's quality as a function of the independent physicochemical properties.<br>

The multiple linear regression model determined the independent physicochemical<br>
properties with the highest statistical influence on wine quality are alcohol<br>
percentage, volatile acidity, sulphates, total sulfur dioxide, chlorides and pH.<br>
Sulphates are added to wine and act as an antimicrobial and antioxidant,<br>
signifying good wines will have a Potassium sulphate concentration of<br>
~0.6 g/dm³. Furthermore, it was discovered good wines contain low quantities<br>
of chlorides, total Sulfur dioxide and pH. The independent variables that have<br>
the maximum statistical influence on a wine quality are volatile acidity and<br>
alcohol percentage. Therefore, good wines will consist of a high alcohol<br>
percentage and a low concentration of volatile acids, which give wines an<br>
unpleasant, vinegar taste. This analysis exposes a strong correlative<br>
relationship between the physicochemical properties of alcohol and volatile<br>
acidity, thus, demonstrating the importance of a wine to be free of<br>
imperfections. 

------


# Reflection

I chose the Red Wine Quality dataset to get a better understanding of how the<br>
physiochemical compounds found in wine affect a wine’s quality. Home brewing<br>
wine is on my bucket list and one of the goals of this data analysis was to<br>
learn what makes a quality wine so that I may implement my findings in the<br>
future. I consider this a success data analysis because I was able to explore<br>
the independent variables and compare them with the dependent quality variable<br>
and gain a clear understanding of the influences that affect wine quality.

The challenge I experienced with this analysis involved implementing the<br>
mathematical algorithm correctly. I initially wanted to create three different<br>
algorithms, a Support Vector Machine (SVM), Decision Tree Regression and<br>
K-Nearest Neighbors (KNN) model and compare the results to provide more accurate<br>
predictions for a wine's quality as a function of the independent<br>
physicochemical properties. I’m not as familiar with R as I am with Python, and<br>
learning the syntax for the machine learning algorithm took too much time,<br>
therefore I decided to simplify matters and conduct a multiple linear regression<br>
model. The linear regression model did very well and I’m proud of how successful<br>
it performed; the next step in the project would be to implement the SVM, KNN<br>
and Decision Tree Regression algorithms for a more robust machine learning<br>
analysis. 

It was exciting to investigate the independent variables for relationships<br>
affecting wine quality. I learned how to make beautiful multivariate graphs and<br>
I created my first multiple linear regression model using R. Overall, I’m<br>
extremely proud of the work I have accomplished with this project.

 



------


### References

    1. Paulo Cortez, António Cerdeira, Fernando Almeida, Telmo Matos, José Reis,
        Modeling wine preferences by data mining from physicochemical properties, 
        In Decision Support Systems, Volume 47, Issue 4, 2009, Pages 547-553,ISSN               
        0167-9236, https://doi.org/10.1016/j.dss.2009.05.016. 
        
        (http://www.sciencedirect.com/science/article/pii/S0167923609001377)
    
    2.  Dataset link: http://www3.dsi.uminho.pt/pcortez/dss09.bib
    
    3.  http://r4stats.com/examples/graphics-ggplot2/
    
    4.  http://datadrivenjournalism.net/resources/when_should_i_use_logarithmic_
        scales_in_my_charts_and_graphs
    
    5.  https://www.r-bloggers.com/multiple-regression-lines-in-ggpairs/
    
    6.  https://stat.ethz.ch/R-manual/R-devel/library/base/html/levels.html
    
    7.  https://www.r-bloggers.com/from-continuous-to-categorical/
    
    8.  http://www.shonscience.com/unit-1-earth-as-a-system2/does-the-shape-size
        -or-temperature-of-matter-affect-its-density
    
    9.  https://machinelearningmastery.com/pre-process-your-dataset-in-r/
    
    10.  http://www.stat.columbia.edu/~martin/W2024/R6.pdf
    
    11.  http://data.library.virginia.edu/diagnostic-plots/
    
    12.  https://www.stat.berkeley.edu/classes/s133/Lr.html
    
    13.  http://www.public.iastate.edu/~maitra/stat501/lectures/Outliers.pdf